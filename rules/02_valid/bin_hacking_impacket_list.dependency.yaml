---
name: bin_hacking_impacket_list.dependency
type: dependency
meta:
  tags: [
      "bin_hacking_impacket",
      #### #### #### #### #### #### #### #### #### #### #### ####
      "type_dependency",
      #### #### #### #### #### #### #### #### #### #### #### ####
    ]
  authors: [" hyde - Benjamin Collas - DIGISQUAD - https://www.digisquad.com"]
  comments:
    - dependency - bin_hacking_impacket_list.dependency

#### #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

matches:
  $bin_dep_01: .data.exe.path ~= "/[^/]*/(impacket|psexec.py|smbclient.py|wmiexec.py|secretsdump.py|ticketer.py|lookupsid.py|getUserSPNs.py|addcomputer.py|dcomexec.py|smbexec.py|ntlmrelayx.py)(-[a-zA-Z0-9._]+)?$"
  $bin_dep_02: .data.ancestors ~= "/[^/]*/(impacket|psexec.py|smbclient.py|wmiexec.py|secretsdump.py|ticketer.py|lookupsid.py|getUserSPNs.py|addcomputer.py|dcomexec.py|smbexec.py|ntlmrelayx.py)(-[a-zA-Z0-9._]+)?$"

  $bin_dep_04: .data.exe.path ~= "/[^/]*/(DumpNTLMInfo.py|Get-GPPPassword.py|GetADComputers.py|GetADUsers.py|GetLAPSPassword.py|GetNPUsers.py|GetUserSPNs.py|addcomputer.py|atexec.py|changepasswd.py|dacledit.py|dcomexec.py|describeTicket.py|dpapi.py|esentutl.py|exchanger.py|findDelegation.py|getArch.py|getPac.py|getST.py|getTGT.py|goldenPac.py|karmaSMB.py|keylistattack.py|kintercept.py|lookupsid.py|machine_role.py|mimikatz.py|mqtt_check.py|mssqlclient.py|mssqlinstance.py|net.py|netview.py|ntfs-read.py|ntlmrelayx.py|owneredit.py|ping.py|ping6.py|psexec.py|raiseChild.py|rbcd.py|rdp_check.py|reg.py|registry-read.py|regsecrets.py|rpcdump.py|rpcmap.py|sambaPipe.py|samrdump.py|secretsdump.py|services.py|smbclient.py|smbexec.py|smbserver.py|sniff.py|sniffer.py|split.py|ticketConverter.py|ticketer.py|tstool.py|wmiexec.py|wmipersist.py|wmiquery.py)(-[a-zA-Z0-9._]+)?$"
  $bin_dep_06: .data.ancestors ~= "/[^/]*/(DumpNTLMInfo.py|Get-GPPPassword.py|GetADComputers.py|GetADUsers.py|GetLAPSPassword.py|GetNPUsers.py|GetUserSPNs.py|addcomputer.py|atexec.py|changepasswd.py|dacledit.py|dcomexec.py|describeTicket.py|dpapi.py|esentutl.py|exchanger.py|findDelegation.py|getArch.py|getPac.py|getST.py|getTGT.py|goldenPac.py|karmaSMB.py|keylistattack.py|kintercept.py|lookupsid.py|machine_role.py|mimikatz.py|mqtt_check.py|mssqlclient.py|mssqlinstance.py|net.py|netview.py|ntfs-read.py|ntlmrelayx.py|owneredit.py|ping.py|ping6.py|psexec.py|raiseChild.py|rbcd.py|rdp_check.py|reg.py|registry-read.py|regsecrets.py|rpcdump.py|rpcmap.py|sambaPipe.py|samrdump.py|secretsdump.py|services.py|smbclient.py|smbexec.py|smbserver.py|sniff.py|sniffer.py|split.py|ticketConverter.py|ticketer.py|tstool.py|wmiexec.py|wmipersist.py|wmiquery.py)(-[a-zA-Z0-9._]+)?$"

  $bin_dep_03: .data.exe.path ~= "/[^/]*/(impacket-Get-GPPPassword|impacket-GetADUsers|impacket-GetNPUsers|impacket-GetUserSPNs|impacket-addcomputer|impacket-atexec|impacket-changepasswd|impacket-dcomexec|impacket-dpapi|impacket-esentutl|impacket-exchanger|impacket-findDelegation|impacket-getArch|impacket-getPac|impacket-getST|impacket-getTGT|impacket-goldenPac|impacket-karmaSMB|impacket-keylistattack|impacket-kintercept|impacket-lookupsid|impacket-machine_role|impacket-mimikatz|impacket-mqtt_check|impacket-mssqlclient|impacket-mssqlinstance|impacket-net|impacket-nmapAnswerMachine|impacket-ntfs-read|impacket-ntlmrelayx|impacket-owneredit|impacket-ping|impacket-ping6|impacket-psexec|impacket-raiseChild|impacket-rbcd|impacket-rdp_check|impacket-reg|impacket-registry-read|impacket-rpcmap|impacket-sambaPipe|impacket-secretsdump|impacket-services|impacket-smbclient|impacket-smbexec|impacket-smbserver|impacket-sniff|impacket-sniffer|impacket-split|impacket-ticketConverter|impacket-ticketer|impacket-tstool|impacket-wmipersist|impacket-wmiquery)(-[a-zA-Z0-9._]+)?$"
  $bin_dep_05: .data.ancestors ~= "/[^/]*/(impacket-Get-GPPPassword|impacket-GetADUsers|impacket-GetNPUsers|impacket-GetUserSPNs|impacket-addcomputer|impacket-atexec|impacket-changepasswd|impacket-dcomexec|impacket-dpapi|impacket-esentutl|impacket-exchanger|impacket-findDelegation|impacket-getArch|impacket-getPac|impacket-getST|impacket-getTGT|impacket-goldenPac|impacket-karmaSMB|impacket-keylistattack|impacket-kintercept|impacket-lookupsid|impacket-machine_role|impacket-mimikatz|impacket-mqtt_check|impacket-mssqlclient|impacket-mssqlinstance|impacket-net|impacket-nmapAnswerMachine|impacket-ntfs-read|impacket-ntlmrelayx|impacket-owneredit|impacket-ping|impacket-ping6|impacket-psexec|impacket-raiseChild|impacket-rbcd|impacket-rdp_check|impacket-reg|impacket-registry-read|impacket-rpcmap|impacket-sambaPipe|impacket-secretsdump|impacket-services|impacket-smbclient|impacket-smbexec|impacket-smbserver|impacket-sniff|impacket-sniffer|impacket-split|impacket-ticketConverter|impacket-ticketer|impacket-tstool|impacket-wmipersist|impacket-wmiquery)(-[a-zA-Z0-9._]+)?$"

condition: any of $bin_dep_
